{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "toc": "true"
   },
   "source": [
    "# Table of Contents\n",
    " <p><div class=\"lev1 toc-item\"><a href=\"#FFT’¤Î’±þ’ÍÑ\" data-toc-modified-id=\"FFT’¤Î’±þ’ÍÑ-1\"><span class=\"toc-item-num\">1&nbsp;&nbsp;</span>FFT’¤Î’±þ’ÍÑ</a></div><div class=\"lev2 toc-item\"><a href=\"#’¼þ’ÇÈ’¿ô’Ê¬’²ò\" data-toc-modified-id=\"’¼þ’ÇÈ’¿ô’Ê¬’²ò-11\"><span class=\"toc-item-num\">1.1&nbsp;&nbsp;</span>’¼þ’ÇÈ’¿ô’Ê¬’²ò</a></div><div class=\"lev2 toc-item\"><a href=\"#’¹â’¼þ’ÇÈ’¥Õ’¥£’¥ë’¥¿’¡¼\" data-toc-modified-id=\"’¹â’¼þ’ÇÈ’¥Õ’¥£’¥ë’¥¿’¡¼-12\"><span class=\"toc-item-num\">1.2&nbsp;&nbsp;</span>’¹â’¼þ’ÇÈ’¥Õ’¥£’¥ë’¥¿’¡¼</a></div><div class=\"lev1 toc-item\"><a href=\"#FFT’¤Î’Æ°’ºî’¸¶’Íý\" data-toc-modified-id=\"FFT’¤Î’Æ°’ºî’¸¶’Íý-2\"><span class=\"toc-item-num\">2&nbsp;&nbsp;</span>FFT’¤Î’Æ°’ºî’¸¶’Íý</a></div><div class=\"lev1 toc-item\"><a href=\"#’´Ø’¿ô’Æâ’ÁÞ’¤È’¤·’¤Æ’¤ÎFourier’´Ø’¿ô’·Ï\" data-toc-modified-id=\"’´Ø’¿ô’Æâ’ÁÞ’¤È’¤·’¤Æ’¤ÎFourier’´Ø’¿ô’·Ï-3\"><span class=\"toc-item-num\">3&nbsp;&nbsp;</span>’´Ø’¿ô’Æâ’ÁÞ’¤È’¤·’¤Æ’¤ÎFourier’´Ø’¿ô’·Ï</a></div><div class=\"lev1 toc-item\"><a href=\"#’Ä¾’¸ò’´Ø’·¸’¤«’¤é’¤Î’ÀÑ’Ê¬’¤Ë’¤è’¤ë’·¸’¿ô’·è’Äê\" data-toc-modified-id=\"’Ä¾’¸ò’´Ø’·¸’¤«’¤é’¤Î’ÀÑ’Ê¬’¤Ë’¤è’¤ë’·¸’¿ô’·è’Äê-4\"><span class=\"toc-item-num\">4&nbsp;&nbsp;</span>’Ä¾’¸ò’´Ø’·¸’¤«’¤é’¤Î’ÀÑ’Ê¬’¤Ë’¤è’¤ë’·¸’¿ô’·è’Äê</a></div><div class=\"lev1 toc-item\"><a href=\"#’Ä¾’ÀÜ’ÀÑ’Ê¬’¤Ë’¤è’¤ë’¥Õ’¡¼’¥ê’¥¨’·¸’¿ô\" data-toc-modified-id=\"’Ä¾’ÀÜ’ÀÑ’Ê¬’¤Ë’¤è’¤ë’¥Õ’¡¼’¥ê’¥¨’·¸’¿ô-5\"><span class=\"toc-item-num\">5&nbsp;&nbsp;</span>’Ä¾’ÀÜ’ÀÑ’Ê¬’¤Ë’¤è’¤ë’¥Õ’¡¼’¥ê’¥¨’·¸’¿ô</a></div><div class=\"lev1 toc-item\"><a href=\"#’Áª’ÅÀ’Ä¾’¸ò’À­’¤Ë’¤è’¤ë’·×’»»’¤Î’´Ê’ÁÇ’²½\" data-toc-modified-id=\"’Áª’ÅÀ’Ä¾’¸ò’À­’¤Ë’¤è’¤ë’·×’»»’¤Î’´Ê’ÁÇ’²½-6\"><span class=\"toc-item-num\">6&nbsp;&nbsp;</span>’Áª’ÅÀ’Ä¾’¸ò’À­’¤Ë’¤è’¤ë’·×’»»’¤Î’´Ê’ÁÇ’²½</a></div><div class=\"lev4 toc-item\"><a href=\"#’Ä¾’¸ò’´Ø’¿ô’·Ï’¤Î’Áª’ÅÀ’Ä¾’¸ò’À­\" data-toc-modified-id=\"’Ä¾’¸ò’´Ø’¿ô’·Ï’¤Î’Áª’ÅÀ’Ä¾’¸ò’À­-6001\"><span class=\"toc-item-num\">6.0.0.1&nbsp;&nbsp;</span>’Ä¾’¸ò’´Ø’¿ô’·Ï’¤Î’Áª’ÅÀ’Ä¾’¸ò’À­</a></div><div class=\"lev2 toc-item\"><a href=\"#’Áª’ÅÀ’Ä¾’¸ò’À­’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì\" data-toc-modified-id=\"’Áª’ÅÀ’Ä¾’¸ò’À­’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì-61\"><span class=\"toc-item-num\">6.1&nbsp;&nbsp;</span>’Áª’ÅÀ’Ä¾’¸ò’À­’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì</a></div><div class=\"lev1 toc-item\"><a href=\"#’¹â’Â®’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¥¢’¥ë’¥´’¥ê’¥º’¥à’¤Ë’¤è’¤ë’¹â’Â®’²½\" data-toc-modified-id=\"’¹â’Â®’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¥¢’¥ë’¥´’¥ê’¥º’¥à’¤Ë’¤è’¤ë’¹â’Â®’²½-7\"><span class=\"toc-item-num\">7&nbsp;&nbsp;</span>’¹â’Â®’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¥¢’¥ë’¥´’¥ê’¥º’¥à’¤Ë’¤è’¤ë’¹â’Â®’²½</a></div><div class=\"lev1 toc-item\"><a href=\"#FFT’´Ø’¿ô’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì\" data-toc-modified-id=\"FFT’´Ø’¿ô’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì-8\"><span class=\"toc-item-num\">8&nbsp;&nbsp;</span>FFT’´Ø’¿ô’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì</a></div><div class=\"lev1 toc-item\"><a href=\"#’²Ý’Âê’¤È’²ò’Åú’Îã\" data-toc-modified-id=\"’²Ý’Âê’¤È’²ò’Åú’Îã-9\"><span class=\"toc-item-num\">9&nbsp;&nbsp;</span>’²Ý’Âê’¤È’²ò’Åú’Îã</a></div><div class=\"lev1 toc-item\"><a href=\"#evalf(funcs[1])];\" data-toc-modified-id=\"evalf(funcs[1])];-10\"><span class=\"toc-item-num\">10&nbsp;&nbsp;</span>evalf(funcs[1])];</a></div>"
   ]
  },
  {
  "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "FFT(Fast Fourier Transformation)\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# FFT’¤Î’±þ’ÍÑ\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "Fast Fourier Transformation(FFT)’¹â’Â®’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹(’¤¢’¤ë’¤¤’¤Ï’¥Ç’¥¸’¥¿’¥ë(’Î¥’»¶)’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹(DFT))’¤Ï’¡¤’¼þ’ÇÈ’¿ô’Ê¬’²ò’¤ä’¥Õ’¥£’¥ë’¥¿’¡¼’¤ò’½é’¤á’¡¤’²è’Áü’½è’Íý’¤Ê’¤É’¤Î’Â¿’¤¯’¤Î’Ê¬’Ìî’¤Ç’»È’¤ï’¤ì’¤Æ’¤¤’¤ë’¡¥’´ð’ËÜ’¤È’¤Ê’¤ë’¹Í’¤¨’Êý’¤Ï’¡¤’Ä¾’¸ò’´ð’Äì’¤Ë’¤è’¤ë’´Ø’¿ô’¤Î’Æâ’ÁÞ’Ë¡’¤Ç’¤¢’¤ë’¡¥’ºÇ’½é’¤Ë’¤½’¤Î’±þ’ÍÑ’Îã’¤ò’¸«’¤¿’¸å’¡¤’¤É’¤Î’¤è’¤¦’¤Ê’Íý’¶þ’¤ÇFFT’¤¬’Æ°’¤¤’¤Æ’¤¤’¤ë’¤«’¤ò’²ò’Àâ’¤¹’¤ë’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ’¼þ’ÇÈ’¿ô’Ê¬’²ò \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "’¤Ï’¤¸’¤á’¤Î’Îã’¤Ï’¡¤’¼þ’ÇÈ’¿ô’Ê¬’²ò’¡¥’Àè’¤º’¤Ï’¡¤’Èó’À°’¹ç’¤Ê’ÇÈ’¤ò’Æó’¤Ä’ÍÑ’°Õ’¤·’¤Æ’¤ª’¤¯’¡¥\n",
    "```maple\n",
    "> restart:\n",
    "  funcs:=[sin(i/13),sin(i/2)];\n",
    "  #funcs:=[sin(i*2),2*sin(i/2)];\n",
    "  plot(funcs,i=0..300);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d1.png,)}}|\n",
    "|:----|\n",
    "\n",
    "’¤³’¤ì’¤ò’½Å’¤Í’¤¢’¤ï’¤»’¤¿’ÇÈ’¤ò’ºî’¤ë’¡¥\n",
    "```maple\n",
    "> data1:=[]:\n",
    "  for i from 1 to 256 do\n",
    "    data1:=[op(data1),evalf(funcs[1]+funcs[2]))]; \n",
    "  end do:\n",
    "  with(plots): \n",
    "  listplot(data1);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d2.png,)}}|\n",
    "|:----|\n",
    "\n",
    "’¤æ’¤Ã’¤¯’¤ê’ÊÑ’²½’¤¹’¤ë’ÇÈ’¤Ë’¡¤’·ã’¤·’¤¯’ÊÑ’²½’¤¹’¤ë’ÇÈ’¤¬’½Å’¤Ê’¤Ã’¤Æ’¤¤’¤ë’¤³’¤È’¤¬’ÆÉ’¤ß’¼è’¤ì’¤ë’¡¥’¤³’¤ì’¤ËFFT’¤ò’³Ý’¤±’¤ë\n",
    "```maple\n",
    "> X:=array(data1): \n",
    "  Y:=array(1..256,sparse):\n",
    "  FFT(8,X,Y);\n",
    "```\n",
    "$$\n",
    "256\n",
    "$$\n",
    "’¤½’¤Î’¶¯’¤µ’¤ò’µá’¤á’¤Æ’¡¤’¼þ’ÇÈ’¿ô’¤Ç’É½’¼¨’¤¹’¤ë’¤È’¡¤\n",
    "```maple\n",
    "> Data2:=[seq([i,sqrt(X[i]^2+Y[i]^2)],i=1..128)]:\n",
    "  plot(Data2);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d3.png,)}}|\n",
    "|:----|\n",
    "\n",
    "’¤â’¤È’¤Î2’¤Ä’¤Î’¼þ’ÇÈ’¿ô’¤Ë’ÂÐ’±þ’¤¹’¤ë’¤È’¤³’¤í’¤Ë’¥Ô’¡¼’¥¯’¤¬’¤Ç’¤­’¤Æ’¤¤’¤ë’¤Î’¤¬’³Î’Ç§’¤Ç’¤­’¤ë’¡¥’¹­’¤¬’¤ê’¤Ï’¡¤’¸í’º¹’¤Î’¤»’¤¤’¡¥\n",
    "logplot’¤Ç’¤â’ÎÉ’¤¤’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ’¹â’¼þ’ÇÈ’¥Õ’¥£’¥ë’¥¿’¡¼ \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "’¼¡’¤Î’Îã’¤Ï’¡¤’¹â’¼þ’ÇÈ’¥Õ’¥£’¥ë’¥¿’¡¼’¡¥’¤¿’¤È’¤¨’¤Ð’¼¡’¤Î’¤è’¤¦’¤Ê’¥í’¡¼’¥ì’¥ó’¥Ä’´Ø’¿ô’¤ò’¹Í’¤¨’¤ë’¡¥\n",
    "```maple\n",
    "> restart;\n",
    "  f1:=t->subs(a=10,b=40000,c=380,d=128,a+b/(c+(t-d)^2));\n",
    "```\n",
    "$$\n",
    "{\\it f1}\\, := \\,t\\mapsto 10+ \\frac{40000}{380+ \\left( t-128 \\right) ^{2} }\n",
    "$$\n",
    "\n",
    "```maple\n",
    "> plot(f1(t),t=1..256);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d4.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "’¤³’¤ì’¤Ë’¥Î’¥¤’¥º’¤¬’¤Î’¤ë’¤È’¡¤’¼¡’¤Î’¤è’¤¦’¤Ë’¤Ê’¤ë’¡¥\n",
    "```maple\n",
    "> T:=[seq(f1(i)*(0.6+0.8*evalf(rand()/10^12)),i=1..256)]:\n",
    "  #T:=[seq(evalf(rand()/10^12),i=1..256)]:  #’¤³’¤ì’¤Ï’¥Û’¥ï’¥¤’¥È’¥Î’¥¤’¥º\n",
    "  #T:=[seq(f1(i),i=1..256)]: #’¤³’¤ì’¤Ï’¸µ’¤Î’´Ø’¿ô’¤½’¤Î’¤Þ’¤Þ\n",
    "  with(plots):\n",
    "  listplot(T);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d5.png,)}}|\n",
    "|:----|\n",
    "\n",
    "’¤³’¤ì’¤Ë’¹â’¼þ’ÇÈ’¥Õ’¥£’¥ë’¥¿’¡¼’¤ò’³Ý’¤±’¤ë’¤È’¥Î’¥¤’¥º’¤¬’¾Ã’¤¨’¤ë’¤¬’¡¤’¤½’¤Î’ÍÍ’»Ò’¤ò’¼¨’¤½’¤¦’¡¥’Àè’¤º’¤Ï’¡¤FFT’¤ò’³Ý’¤±’¤ë’¡¥\n",
    "```maple\n",
    "> Idata:=array([seq(0,i=1..256)]):\n",
    "  Rdata:=convert(T,array):\n",
    "  FFT(8,Rdata,Idata);\n",
    "```\n",
    "$$\n",
    "256\n",
    "$$\n",
    "’¤³’¤ì’¤Ï’¼¡’¤Î’¤è’¤¦’¤Ê’¶¯’ÅÙ’Ê¬’ÉÛ’¤ò’¤â’¤Ã’¤Æ’¤¤’¤ë’¡¥\n",
    "```maple\n",
    "> Adata:=[seq([i,sqrt(Idata[i]^2+Rdata[i]^2)],i=1..128)]:\n",
    "> logplot(Adata);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d6.png,)}}|\n",
    "|:----|\n",
    "\n",
    "’Äã’¼þ’ÇÈ’¤Î’Éô’Ê¬’¤Ë’¡¤’¤æ’¤Ã’¤¯’¤ê’¤È’¤·’¤¿’ÊÑ’²½’¤ò’É½’¤¹’À®’Ê¬’¤¬’¸Ç’¤Þ’¤Ã’¤Æ’¤¤’¤ë’¡¥’¼¡’¤Î’¤è’¤¦’¤Ê’»°’³Ñ’¥Õ’¥£’¥ë’¥¿’¡¼’¤ò’ÍÑ’°Õ’¤¹’¤ë’¡¥’¤³’¤ì’¤Ï’¡¤’Äã’¼þ’ÇÈ’¤Û’¤É’±Æ’¶Á’¤ò’Âç’¤­’¤¯’¤¹’¤ë’¥Õ’¥£’¥ë’¥¿’¡¼’¡¥\n",
    "```maple\n",
    "> filter:=x->piecewise(x>=0 and x<=20,(1-x/20)): #’»°’³Ñ’¥Õ’¥£’¥ë’¥¿’¡¼\n",
    "  #filter:=x->piecewise(x>=0 and x<=20,1); #’Êý’·Á’¥Õ’¥£’¥ë’¥¿’¡¼\n",
    "  plot(filter(x),x=0..40);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d7.png,)}}|\n",
    "|:----|\n",
    "\n",
    "’¤³’¤ì’¤È’¥Ç’¡¼’¥¿’¤ò’³Æ’ÅÀ’¤Ç’³Ý’¤±’¤¢’¤ï’¤»’¤ë’»ö’¤Ë’¤è’¤Ã’¤Æ’¡¤’¥Õ’¥£’¥ë’¥¿’¡¼’¤ò’ÄÌ’¤·’¤¿’¤³’¤È’¤Ë’¤Ê’¤ë’¡¥\n",
    "```maple\n",
    "> FRdata:=array([seq(Rdata[i]*filter(i),i=1..256)]):\n",
    "> FIdata:=array([seq(Idata[i]*filter(i),i=1..256)]):\n",
    "```\n",
    "’Àè’¤Û’¤É’¤È’Æ±’ÍÍ’¤Ë’É½’¼¨’¤¹’¤ë’¤È\n",
    "```maple\n",
    "> Bdata:=[seq([i,sqrt(FIdata[i]^2+FRdata[i]^2)],i=1..128)]:\n",
    "> logplot(Adata);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot3d6.png,)}}|\n",
    "|:----|\n",
    "\n",
    "$i=20$’°Ê’¾å’¤Î’ÎÎ’°è’¤¬’¥Õ’¥£’¥ë’¥¿’¡¼’¤Ë’¤è’¤Ã’¤Æ’¤Á’¤ç’¤ó’ÀÚ’¤é’¤ì’¤Æ’¤¤’¤ë’¤³’¤È’¤¬’³Î’Ç§’¤Ç’¤­’¤ë’¡¥’¤³’¤ì’¤ò’µÕ’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¤¹’¤ë’¡¥\n",
    "```maple\n",
    "> iFFT(8,FRdata,FIdata);\n",
    "```\n",
    "$$\n",
    "256\n",
    "$$\n",
    "’¤³’¤ì’¤ò’É½’¼¨’¤¹’¤ë’¤È’¡¤\n",
    "```maple\n",
    "> listplot(FRdata);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d8.png,)}}|\n",
    "|:----|\n",
    "\n",
    "’¤È’¤Ê’¤ë’¡¥’¥Î’¥¤’¥º’¤¬’¼è’¤ê’½ü’¤«’¤ì’¤Æ’¤¤’¤ë’¤Î’¤¬’³Î’Ç§’¤Ç’¤­’¤ë’¡¥’¸µ’¤Î’´Ø’¿ô’¤Ë’²Ã’¤¨’¤¿’¥Û’¥ï’¥¤’¥È’¥Î’¥¤’¥º’¤ËFFT’¤ò’³Ý’¤±’¤ì’¤Ð’Ê¬’¤«’¤ë’¤¬’¡¤’Á´’¼þ’ÇÈ’¿ô’°è’¤Ë’¤ï’¤¿’¤Ã’¤Æ’¶Ñ’¼Á’¤Ë’¹­’¤¬’¤Ã’¤¿’´Ø’¿ô’¤È’¤Ê’¤ë’¡¥’¤³’¤ì’¤ò’»°’³Ñ’¥Õ’¥£’¥ë’¥¿’¡¼’¤Ê’¤É’¤Ç’¹â’¼þ’ÇÈ’À®’Ê¬’¤ò’¥«’¥Ã’¥È’¤¹’¤ë’¤³’¤È’¤Ç’¡¤’¥Î’¥¤’¥º’¤¬’¼è’¤ê’½ü’¤«’¤ì’¤Æ’¤¤’¤¯’¤Î’¤¬’Íý’²ò’¤µ’¤ì’¤è’¤¦’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# FFT’¤Î’Æ°’ºî’¸¶’Íý\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "’¤³’¤Î’¤è’¤¦’¤Ë’ÊØ’Íø’¤ÊFFT’¤Ç’¤¢’¤ë’¤¬’¡¤’¤É’¤Î’¤è’¤¦’¤Ê’Íý’¶þ’¤Ç’Æ³’¤«’¤ì’¤ë’¤Î’¤«’¡©’¡¡Fourier’ÊÑ’´¹’Ë¡’¤Ï’¡¤’¤³’¤Î’²Ý’Âê’¤À’¤±’¤Ç’¤â’²¿’²ó’¤â’¤Î’¥³’¥Þ’¿ô’¤¬’É¬’Í×’¤Ê’¤Û’¤É’¤Î’Æâ’ÍÆ’¤ò’´Þ’¤ó’¤Ç’¤¤’¤ë’¡¥’¤³’¤³’¤Ç’¤Ï’¡¤\n",
    "’¤½’¤Î’´ð’ËÜ’¤È’¤Ê’¤ë’¹Í’¤¨’Êý’¡Ê’¤Î’¤Ò’¤È’¤Ä)’¤À’¤±’¤ò’Äó’¼¨’¤¹’¤ë’¡¥\n",
    "1.  ’´Ø’¿ô’¤Î’Æâ’ÁÞ’¤Ç’Æ³’Æþ’¤·’¤¿’´ð’Äì’´Ø’¿ô’¤ò’Ä¾’¸ò’´Ø’¿ô’·Ï’¤Ç’¤È’¤ë’¡¥’¤È’¤³’¤í’¤¬’¡¤’Å¸’³«’·¸’¿ô’¤ò’µÕ’¹Ô’Îó’¤Ç’µá’¤á’¤ë’¼ê’Ë¡’¤Ç’¤Ï’·×’»»’¤¬’ÇË’Ã¾’¡¥\n",
    "1.  ’Ä¾’¸ò’´Ø’·¸’¤«’¤é’¤Î’ÀÑ’Ê¬’¤Ë’¤è’¤ë’·¸’¿ô’·è’Äê’¡¥\n",
    "1.  ’Áª’ÅÀ’Ä¾’¸ò’À­’¤Ë’¤è’¤ë’·×’»»’¤Î’´Ê’ÁÇ’²½’¡¥\n",
    "1.  ’¹â’Â®’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¥¢’¥ë’¥´’¥ê’¥º’¥à’¤Ë’¤è’¤ë’¹â’Â®’²½’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ’´Ø’¿ô’Æâ’ÁÞ’¤È’¤·’¤Æ’¤ÎFourier’´Ø’¿ô’·Ï\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "’°ì’Ï¢’¤Î’´Ø’¿ô’·Ï’¤Ë’¤è’¤ë’´Ø’¿ô’¤Î’Æâ’ÁÞ’¤Ï’¡¤’´ð’Äì’´Ø’¿ô’¤ò$\\varphi_n(x)$’¤È’¤·’¤Æ\n",
    "\n",
    "$$\n",
    "F(x) = \\sum^N_{n=1}a_n \\varphi_n(x)\n",
    "$$\n",
    "’¤Ç’ÆÀ’¤é’¤ì’¤ë’¤³’¤È’¤ò’¸«’¤¿’¡¥\n",
    "Fourier’ÊÑ’´¹’¤Ç’¤Ï’´ð’Äì’´Ø’¿ô’¤È’¤·’¤Æ$\\varphi _{n} \\left( x \\right) =\\sin \\left( 2\\,\\pi {\\it nx} \\right) ,\\,\\cos \\left( 2\\,\\pi {\\it nx} \\right)$’¤ò’¤È’¤ë’¡¥’´Ø’¿ô’¤Î’Æâ’ÁÞ’Ë¡’¤Ç’¼¨’¤·’¤¿’¤è’¤¦’¤Ë’¡¤’¤³’¤Î$x_i$’¤Ç’¤Î’ÃÍ$f_i, i=1 \\cdots M$’¤È’¡¤’¶á’»÷’¤Î’¼¡’¿ô($N$)’¤È’¤Ç’¤Ä’¤¯’¤ë’·¸’¿ô’¹Ô’Îó’¡¤\n",
    "\n",
    "$$\n",
    "A=\\left[ \\begin{array}{cccc}\n",
    "\\varphi_0(x_0)&\\varphi_1(x_0)& \\cdots &\\varphi_N(x_0) \\\\\n",
    "\\vdots & \\vdots & \\vdots & \\vdots \\\\\n",
    "\\varphi_0(x_M)&\\varphi_1(x_M)& \\cdots &\\varphi_N(x_M) \n",
    "\\end{array}\\right]\n",
    "$$\n",
    "’¤ò’µá’¤á’¤Æ’¡¤’·¸’¿ô$a_i$’¤È’¥Ç’¡¼’¥¿’ÅÀ$f_i$’¤ò’¤½’¤ì’¤¾’¤ì’¥Ù’¥¯’¥È’¥ë’¤È’¹Í’¤¨’¤ë’¤È’¡¤\n",
    "\n",
    "$$\n",
    "\\boldsymbol{A}.\\boldsymbol{a} = \\boldsymbol{f}\n",
    "$$\n",
    "’¤«’¤é’¡¤’ÄÌ’¾ï’¤Î’µÕ’¹Ô’Îó’¤ò’µá’¤á’¤ë’¼ê’Ë¡’¤Ç’·¸’¿ô’¤ò’·è’Äê’¤¹’¤ë’¤³’¤È’¤â’¤Ç’¤­’¤ë’¡¥’¤·’¤«’¤·’¡¤’¤³’¤Î’¶¯’°ú’¤Ê’Êý’Ë¡’¤Ï’¥Ç’¡¼’¥¿’¿ô’¡¤’´Ø’¿ô’¤Î’¼¡’¿ô’¤¬’Â¿’¤¤’¡¤’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¤¬’ÂÐ’¾Ý’¤È’¤·’¤è’¤¦’¤È’¤¹’¤ë’Ìä’Âê’¤Ç’¤Ï’ÇË’Ã¾’¤¹’¤ë’¡¥’¤â’¤Ã’¤È’¤¤’¤¤’Êý’Ë¡’¤¬’É¬’Í×’¤Ç’¡¤’¤½’¤ì’¤¬’Ä¾’¸ò’´Ø’¿ô’·Ï’¤Ç’¤Ï’Â¸’ºß’¤¹’¤ë’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ’Ä¾’¸ò’´Ø’·¸’¤«’¤é’¤Î’ÀÑ’Ê¬’¤Ë’¤è’¤ë’·¸’¿ô’·è’Äê\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "’´Ø’¿ô’¤Î’Ä¾’¸ò’´Ø’·¸’¤Ï’¡¤\n",
    "$$\n",
    "\\int _{a}^{b}\\varphi _{n} \\left( x \\right) \\varphi _{m} \\left( x \\right) {dx}=\n",
    "\\delta_{\\it mn}C_{n}= \\left\\{\\begin{array}{lr}\n",
    "C_m & at\\, n=m \\\\\n",
    "0 & at\\, n\\neq m\n",
    "\\end{array}\\right.\n",
    "$$\n",
    "’¤Ç’¤¢’¤ë’¡¥’Äê’¿ô$C_m$’¤Ï’¡¤$\\sin,\\cos$’¤Î’»°’³Ñ’´Ø’¿ô’·Ï’¤Ç’¤Ï’¼¡’¤Î’ÄÌ’¤ê’¡¥\n",
    "```maple\n",
    "> plot([sin(x),sin(3*x)],x=0..2*Pi);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d9.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "```maple\n",
    "> plot([sin(x)*sin(3*x)],x=0..2*Pi, color=black);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d10.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "```maple\n",
    "> int(sin(x)*sin(3*x),x=0..2*Pi);\n",
    "```\n",
    "$$\n",
    "0\n",
    "$$\n",
    "```maple\n",
    "> for i from 1 to 3 do for j from 1 to 3 do S:=int(sin(i*x)*sin(j*x),x=0..2*Pi);\n",
    "> print(i,j,S); end do; end do:\n",
    "```\n",
    "$$\n",
    "1, 1, \\pi \\notag \\\\\n",
    "1, 2, 0 \\notag \\\\\n",
    "1, 3, 0 \\notag \\\\\n",
    "2, 1, 0 \\notag \\\\\n",
    "2, 2, \\pi \\notag \\\\\n",
    "2, 3, 0 \\notag \\\\\n",
    "3, 1, 0 \\notag \\\\\n",
    "3, 2, 0 \\notag \\\\\n",
    "3, 3, \\pi \\notag\n",
    "$$\n",
    "\n",
    "$$\n",
    "\\int _{a}^{b}F \\left( x \\right) \\varphi _{m} \\left( x \\right) {dx}\n",
    "$$\n",
    "’¤ò’¹Í’¤¨’¤ë’¡¥’Àè’Äø’¤Î\\ref{Eq:Orthogonal}’¼°’¤ò’¤¤’¤ì’¤ë’¤È\n",
    "$$\n",
    "\\int _{a }^{b }F \\left(x \\right)\\varphi _{m }\\left(x \\right) dx =\\int _{a }^{b }{\\sum^N_{n=1} }a _{n }\\varphi _{n }\\left(x \\right)\\varphi _{m }\\left(x \\right)d x = \n",
    "\\left\\{\\begin{array}{lr}\n",
    "a_m C_m & at\\, n=m \\\\\n",
    "0 & at\\, n\\neq m\n",
    "\\end{array}\\right.\n",
    "$$\n",
    "’¤È’¤Ê’¤ë’¡¥’¤³’¤¦’¤·’¤Æ’¡¤’·¸’¿ô$a_n$’¤¬\n",
    "\n",
    "$$\n",
    "a_{{n}}=\\frac {1}{C_n}\\int _{a}^{b} F \\left( x \\right) \\varphi _{{n}} \\left( x \\right) {dx}\n",
    "$$\n",
    "’¤Ç’·è’Äê’¤Ç’¤­’¤ë’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ’Ä¾’ÀÜ’ÀÑ’Ê¬’¤Ë’¤è’¤ë’¥Õ’¡¼’¥ê’¥¨’·¸’¿ô\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "’ÂÐ’¾Ý’¤È’¤¹’¤ë’´Ø’¿ô’¤ò’¤Þ’¤º’ºî’¤ë’¡¥\n",
    "```maple\n",
    "> restart;\n",
    "> #F:=x->piecewise(x=0,1/2,x>0,x); \n",
    "  #F:=x->piecewise(x<1/2,x,x>=1/2,1-x);\n",
    "  #F:=x->piecewise(x<1/2,-1,x>1/2,1); \n",
    "  F:=x->piecewise(x<1/2,-1,x>=1/2,1);\n",
    "  #F:=x->piecewise(x>0 and x<1/2,-1,x>1/2,1); \n",
    "  #F:=x->x-1/2; \n",
    "  plot(F(x),x=0..1);\n",
    "```\n",
    "$$\n",
    "F := x \\mapsto piecewise(x < \\frac{1}{2}, -1, \\frac{1}{2} \\leq x, 1) \n",
    "$$\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d11.png,)}}|\n",
    "|:----|\n",
    "\n",
    "piecewise’´Ø’¿ô’¤Ï’³¬’ÃÊ’´Ø’¿ô’¤Ç’¡¤’¿¶’¤ë’Éñ’¤¤’¤Ï’¥³’¥á’¥ó’¥È(\\#)’¤ò’Å¬’Åö’¤Ë’³°’¤·’¤Æ’³Î’Ç§’¤»’¤è’¡¥\n",
    "’½é’´ü’Àß’Äê’¡¥\n",
    "```maple\n",
    "> KK:=3; N:=2^KK;L:=1-0;\n",
    "> 2*Pi*1/L*x;\n",
    "```\n",
    "$$\n",
    "2 \\pi x\n",
    "$$\n",
    "```maple\n",
    "> int(F(x)*cos(2*Pi*1/L*x),x=0..L);\n",
    "```\n",
    "$$\n",
    "0\n",
    "$$\n",
    "\n",
    "```maple\n",
    "> for n from 0 to N do\n",
    "    a[n]:=2/L*int(F(x)*cos(2*Pi*n/L*x),x=0..L); \n",
    "  end do;\n",
    "```\n",
    "$$\n",
    "a_0:=0 \\notag \\\\\n",
    "a_1:=0 \\notag \\\\\n",
    "a_2:=0 \\notag \\\\\n",
    "a_3:=0 \\notag \\\\\n",
    "a_4:=0 \\notag \\\\\n",
    "a_5:=0 \\notag \\\\\n",
    "a_6:=0 \\notag \\\\\n",
    "a_7:=0 \\notag \\\\\n",
    "a_8:=0 \\notag \n",
    "$$\n",
    "\n",
    "```maple\n",
    "> for n from 0 to N do \n",
    "    b[n]:=2/L*int(F(x)*sin(2*Pi*n/L*x),x=0..L); \n",
    "  end do;\n",
    "```\n",
    "$$\n",
    "b_0:=0 \\notag \\\\\n",
    "b_1:=\\frac{4}{\\pi} \\notag \\\\\n",
    "b_2:=0 \\notag \\\\\n",
    "b_3:=\\frac{4}{3\\pi} \\notag \\\\\n",
    "b_4:=0 \\notag \\\\\n",
    "b_5:=\\frac{4}{5\\pi} \\notag \\\\\n",
    "b_6:=0 \\notag \\\\\n",
    "b_7:=\\frac{4}{7\\pi} \\notag \\\\\n",
    "b_8:=0 \\notag \n",
    "$$\n",
    "’¤³’¤³’¤Ç’¡¤’¥ª’¥¤’¥é’¡¼’¤Î’´Ø’·¸\n",
    "$$\n",
    "a[n]=c[n]+c[-n],\\, b[n]=I (c[n]-c[-n]) \\notag \\\\\n",
    "c[-n]= \\frac{1}{2} (a[n] + b[n]),\\, c[n]=\\frac{1}{2} (a[n] - I b[n])\n",
    "$$\n",
    "’¤ò’»È’¤Ã’¤Æ’¡¤’»°’³Ñ’´Ø’¿ô’·Ï’¤«’¤é$\\exp$’¤Ø’ÊÑ’´¹’¤¹’¤ë’¡¥\n",
    "\n",
    "```maple\n",
    "> for n from 0 to N do c[n]:=1/L*int(F(x)*exp(-I*2*Pi*n/L*x),x=0..L); end do;\n",
    "> for n from 1 to N do c[-n]:=1/L*int(F(x)*exp(I*2*Pi*n/L*x),x=0..L); end do;\n",
    "```\n",
    "$$\n",
    "c_0:=0 \\notag \\\\\n",
    "c_1:=\\frac{2I}{\\pi} \\notag \\\\\n",
    "c_2:=0 \\notag \\\\\n",
    "c_3:=\\frac{2I}{3\\pi} \\notag \\\\\n",
    "c_4:=0 \\notag \\\\\n",
    "c_5:=\\frac{2I}{5\\pi} \\notag \\\\\n",
    "c_6:=0 \\notag \\\\\n",
    "c_7:=\\frac{2I}{7\\pi} \\notag \\\\\n",
    "c_8:=0 \\notag \\\\\n",
    "c_{-1}:=-\\frac{2I}{\\pi} \\notag \\\\\n",
    "c_{-2}:=0 \\notag \\\\\n",
    "c_{-3}:=-\\frac{2I}{3\\pi} \\notag \\\\\n",
    "c_{-4}:=0 \\notag \\\\\n",
    "c_{-5}:=-\\frac{2I}{5\\pi} \\notag \\\\\n",
    "c_{-6}:=0 \\notag \\\\\n",
    "c_{-7}:=-\\frac{2I}{7\\pi} \\notag \\\\\n",
    "c_{-8}:=0 \\notag \n",
    "$$\n",
    "\n",
    "```maple\n",
    "> F1:=unapply(sum(evalf(c[i]*exp(I*2*Pi*i/L*x)),i=-(N-1)..(N-1)),x):\n",
    "> plot({Re(F1(x)),F(x)},x=0..1);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d12.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "```maple\n",
    "> evalf(2/3/Pi);\n",
    "```\n",
    "$$\n",
    "0.2122065907\n",
    "$$\n",
    "```\n",
    "\n",
    "```\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ’Áª’ÅÀ’Ä¾’¸ò’À­’¤Ë’¤è’¤ë’·×’»»’¤Î’´Ê’ÁÇ’²½\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "’¤È’¤³’¤í’¤¬’¡¤’¼Â’ºÝ’¤Ë’ÀÑ’Ê¬’¤·’¤Æ’¤¤’¤Æ’¤Ï’¡¤’»þ’´Ö’¤¬’¤«’¤«’¤ê’¤¹’¤®’¤ë’¡¥’Ä¾’¸ò’´Ø’¿ô’·Ï’¤Î’Áª’ÅÀ’Ä¾’¸ò’À­’¤ò’»È’¤¦’¤È’¤è’¤ê’´Ê’Ã±’¤Ë’¤Ê’¤ë’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### ’Ä¾’¸ò’´Ø’¿ô’·Ï’¤Î’Áª’ÅÀ’Ä¾’¸ò’À­ \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "’Ä¾’¸ò’Â¿’¹à’¼°’¤Ï’¡¤\n",
    "\n",
    "$$\n",
    "\\varphi _{n} \\left( x \\right) =0 \\,at\\,x_1,\\,x_2,\\,\\cdots x_{n}\n",
    "$$\n",
    "’¤Ç’¤¢’¤ë’¡¥$n-1$’°Ê’²¼’¤Î’¼¡’¿ô$m,\\,l$’¤Ç’¤Ï’¡¤\n",
    "\n",
    "$$\n",
    "\\sum _{i=1}^{n}\\phi_{l} \\left( x_{i} \\right) \\varphi _{m} \\left( x_{i} \\right) =\\delta_{\\it ml}C_{l}\n",
    "$$\n",
    "’¤¬’À®’¤ê’Î©’¤Ä’¡¥’¤³’¤ì’¤Ï’¡¤’Ä¾’¸ò’´Ø’·¸’¤È’°ã’¤¤’ÀÑ’Ê¬’¤Ç’¤Ê’¤¤’¤³’¤È’¤Ë’Ãí’°Õ’¡¥’¾Ú’ÌÀ’¤Ï’Î¬’¡¥\n",
    "’¤³’¤ì’¤ò’»È’¤¨’¤Ð’¡¤’¤³’¤Î’Àè’Äø’¤Î’Ä¾’¸ò’´Ø’¿ô’Å¸’³«\n",
    "\n",
    "$$\n",
    "F \\left( x \\right) =\\sum _{l=1}^{N}a_{l}\\varphi _{l} \\left( x \\right)\n",
    "$$\n",
    "’¤Î’Î¾’ÊÕ’¤Ë$\\varphi _{m} \\left( x_{i} \\right)$’¤ò’³Ý’¤±’¤Æ$i$’¤Ë’¤Ä’¤¤’¤Æ’ÏÂ’¤ò’¤È’¤ì’¤Ð’¡¤\n",
    "$$\n",
    "\\sum _{i=1}^{n} F \\left(x _{i }\\right)\\phi _{m }\\left(x _{i }\\right) = \\\\\n",
    "\\sum _{i=1}^{n}  \\sum _{l=1}^{N}a_{l}\\varphi _{l} \\left( x_{i} \\right) \\varphi _{m} \\left( x_{i} \\right)  \\notag \\\\\n",
    "=\\sum _{l=1}^{N}  a_{l}\\sum _{i=1}^{n}\\varphi _{l} \\left( x_{i} \\right) \\varphi _{m} \\left( x_{i} \\right) \\notag \\\\\n",
    "=\\sum _{l=1}^{N}a_{l}\\delta_{\\it ml}C_{m}=a_{m}C_{m} \\notag\n",
    "$$\n",
    "’¤È’¤Ê’¤ë’¡¥’¤Ä’¤Þ’¤ê’¡¤\n",
    "\n",
    "$$\n",
    "a_{m}=\\frac{1}{C_{m}} {\\sum _{i=1}^{n}F \\left( x_{i} \\right) \\varphi _{m} \\left( x_{i} \\right) }\n",
    "$$\n",
    "’¤È’¤Ê’¤ê’¡¤’Ã±’½ã’¤Ê’´Ø’¿ô’¤Î’Âå’Æþ’¤È’¤«’¤±’»»’¤Ç’·¸’¿ô’¤¬’·è’Äê’¤µ’¤ì’¤ë’¡¥\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ’Áª’ÅÀ’Ä¾’¸ò’À­’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```maple\n",
    "> KK:=4; N:=2^KK;L:=1-0;\n",
    "> for k from 0 to N-1 do \n",
    "    c[k]:=evalf(sum(F(i*L/N)*exp(-I*2*Pi*k*i/N),i=0..N-1));\n",
    "  end do;\n",
    "```\n",
    "```maple\n",
    "c_0:=0. \n",
    "c_1:=-2.000000000 + 10.05467898 I \n",
    "c_2:=0. \n",
    "c_3:=-2.000000000 + 2.993211524 I \n",
    "c_4:=0. \n",
    "c_5:=-2.000000001 + 1.336357276 I \n",
    "c_6:=0. \n",
    "c_7:=-2.000000001 + 0.3978247331 I \n",
    "c_8:=0. \n",
    "c_9:=-2.000000001 - 0.3978247331 I \n",
    "c_10:=0. \n",
    "c_11:=-2.000000001 - 1.336357276 I \n",
    "c_12:=0. \n",
    "c_13:=-2.000000000 - 2.993211524 I \n",
    "c_14:=0. \n",
    "c_15:=-2.000000000 - 10.05467898 I\n",
    "```\n",
    "\n",
    "```maple\n",
    "> F1:=unapply(sum(evalf(c[i]*exp(I*2*Pi*i/L*x)/N),i=0..(N/2-1))+\n",
    "> sum(evalf(c[N-i]*exp(-I*2*Pi*i/L*x)/N),i=1..(N/2-1)),x):\n",
    "> plot({Re(F1(x)),F(x)},x=0..1);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d13.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ’¹â’Â®’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¥¢’¥ë’¥´’¥ê’¥º’¥à’¤Ë’¤è’¤ë’¹â’Â®’²½\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "$\\sin, \\cos$’¤È$\\exp$’´Ø’¿ô’¤ò’·ë’¤Ó’¤Ä’¤±’¤ë’¥ª’¥¤’¥é’¡¼’¤Î’´Ø’·¸’¤ò’»È’¤¦’¤È’¡¤\n",
    "\n",
    "$$\n",
    "$$\n",
    "’¤È’ÊÑ’´¹’¤Ç’¤­’¤ë’¡¥’¤³’¤ì’¤ò’»È’¤¦’¤È’¡¤\n",
    "\n",
    "$$\n",
    "c_{{k}}=\\frac{1}{C_{{m}}}\\sum _{i=0}^{N-1}F \\left( x_{{i}} \\right) {{\\exp}\\left({{\\frac {-2\\,\\pi I}{N}}}\\right)}\n",
    "$$\n",
    "’¤È’¤Ê’¤ë’¡¥$N = 8$’¤Î’¾ì’¹ç’¤ò’¼Â’ºÝ’¤Ë’·×’»»’¤¹’¤ë’¤È’¡¤$ z = \\exp(-\\frac{2\\pi}{8}I)$’¤È’¤·’¤Æ’¡¤$z^8=1,z^9=z, \\cdots$’¤ò’»È’¤¦’¤È’¡¤\n",
    "\n",
    "$$\n",
    "\\left[\\begin{array}{c}\n",
    "c_0\\\\c_1\\\\c_2\\\\c_3\\\\c_4\\\\c_5\\\\c_6\\\\c_7\n",
    "\\end{array}\\right] =\n",
    "\\left[\\begin{array}{cccccccc}\n",
    "1&1&1&1&1&1&1&1\\\\\n",
    "1&z&z^2&z^3&z^4&z^5&z^6&z^7\\\\\n",
    "1&z^2&z^4&z^6&1&z^2&z^4&z^6\\\\\n",
    "1&z^3&z^6&z&z^4&z^7&z^2&z^5\\\\\n",
    "1&z^4&1&z^4&1&z^4&1&z^4\\\\\n",
    "1&z^5&z^2&z^7&z^4&z^1&z^6&z^3\\\\\n",
    "\\vdots & & & & & & &  \\\\\n",
    "\\vdots & & & & & & & \n",
    "\\end{array}\\right]\n",
    "\\left[\\begin{array}{c}\n",
    "F_0\\\\F_1\\\\F_2\\\\F_3\\\\F_4\\\\F_5\\\\F_6\\\\F_7\n",
    "\\end{array}\\right]\n",
    "$$\n",
    "’¤È’¤Ê’¤ë’¡¥’¤³’¤Î’¹Ô’Îó’·×’»»’¤ò’ÁÇ’Ä¾’¤Ë’¼Â’¹Ô’¤¹’¤ë’¤È’¡¤8×8=64’²ó’¤Î’±é’»»’¤¬’É¬’Í×’¤È’¤Ê’¤ë’¡¥’¤³’¤ì’¤ò’¸º’¤é’¤»’¤Ê’¤¤’¤«’¤È’¹Í’¤¨’¤¿’¤Î’¤¬’¡¤’¹â’Â®’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¤Î’»Ï’¤Þ’¤ê’¤Ç’¤¢’¤ë’¡¥\n",
    "’¤³’¤Î’¹Ô’Îó’¤ò’¤è’¤¯’¸«’¤ë’¤È’Æ±’¤¸’·×’»»’¤ò’½Å’Ê£’¤·’¤Æ’¤ª’¤³’¤Ê’¤Ã’¤Æ’¤¤’¤ë’¤³’¤È’¤¬’Ê¬’¤«’¤ë’¡¥’¤½’¤³’¤Ç’¡¤’¹Ô’Îó’¤Î’º¸’Â¦’¤È’±¦’Â¦’¤Ç’Æ±’¤¸’·×’»»’¤ò’¤·’¤Æ’¤¤’¤ë’Éô’Ê¬’¤ò’¤Þ’¤È’¤á’¤ë’¤È’¡¤\n",
    "\n",
    "$$\n",
    "\\left[\\begin{array}{c}\n",
    "c_0\\\\c_1\\\\c_2\\\\c_3\\\\c_4\\\\c_5\\\\c_6\\\\c_7\n",
    "\\end{array}\\right] =\n",
    "\\left[\\begin{array}{cccccccc}\n",
    "1&1&1&1&0&0&0&0\\\\\n",
    "0&0&0&0&1&z&z^2&z^3\\\\\n",
    "1&z^2&z^4&z^6&0&0&0&0\\\\\n",
    "0&0&0&0&1&z^3&z^6&z\\\\\n",
    "1&z^4&1&z^4&0&0&0&0\\\\\n",
    "0&0&0&0&1&z^5&z^2&z^7\\\\\n",
    "1&z^6&z^4&z^2&0&0&0&0\\\\\n",
    "0&0&0&0&1&z^7&z^6&z^5\\\\\n",
    "\\end{array}\\right]\n",
    "\\left[\\begin{array}{c}\n",
    "F_0+F_4\\\\F_1+F_5\\\\F_2+F_6\\\\F_3+F_7\\\\F_0-F_4\\\\F_1-F_5\\\\F_{[ \\,\\,]}-F_6\\\\F_{[\\,\\,]}-F_7\n",
    "\\end{array}\\right]\n",
    "$$\n",
    "’¤È’¤¹’¤ë’¤³’¤È’¤¬’¤Ç’¤­’¤ë’¡¥’¤³’¤³’¤Ç’¡¤$z^4 =-1$’¤Ê’¤É’¤ò’»È’¤Ã’¤Æ’¤¤’¤ë’¡¥’±¦’Â¦’¤Î’¥Ù’¥¯’¥È’¥ë’¤Î’·×’»»’¤Ç’¥í’¥¹’¤¹’¤ë’¤¬’¡¤’¹Ô’Îó’¤Î’Ãæ’¤Î’·×’»»’¤Î’²ó’¿ô’¤ò’È¾’Ê¬’¤Ë’¸º’¤é’¤¹’¤³’¤È’¤¬’¤Ç’¤­’¤ë’¡¥’ºÆ’ÅÙ’¤Ç’¤­’¤¢’¤¬’¤Ã’¤¿’¹Ô’Îó’¤ò’¸«’¤ì’¤Ð’¡¤’Æ±’¤¸’·×’»»’¤ò’¤µ’¤é’¤Ë’¤Þ’¤È’¤á’¤ë’¤³\n",
    "’¤È’¤¬’¤Ç’¤­’¤½’¤¦’¤Ç’¤¢’¤ë’¡¥’¤³’¤¦’¤·’¤Æ’¡¤’¼¡’¡¹’¤È’·×’»»’²ó’¿ô’¤ò’¸º’¤é’¤·’¤Æ’¤¤’¤¯’¤³’¤È’¤¬’²Ä’Ç½’¤Ç’¡¤’ºÇ’½ª’Åª’¤Ë’¹Ô’Îó’Éô’Ê¬’¤Î’·×’»»’¤¬’°ì’ÀÚ’¤Ê’¤¯’¤Ê’¤ë’¡¥’»Ä’¤ë’¤Î’¤Ï’¡¤’±¦’Â¦’¤Î’¥Ù’¥¯’¥È’¥ë’¤Î’Â­’¤·’»»’°ú’¤­’»»’¤À’¤±’¤Ë’¤Ê’¤ë’¡¥\n",
    "\n",
    "’¤³’¤Î’¥Ù’¥¯’¥È’¥ë’¤Î’ÁÈ’¤ß’¹ç’¤ï’¤»’¤Ï’¡¤’°ì’¸«’Áê’Åö’Ê£’»¨’¤½’¤¦’¤Ç’¡¤’¤½’¤Î’¾ò’·ï’Ê¬’´ô’¤Ç’»þ’´Ö’¤¬’¤«’¤«’¤ê’¤½’¤¦’¤Ë’»×’¤ï’¤ì’¤ë’¡¥’¤·’¤«’¤·’¡¤’¤è’¤¯’Ä´’¤Ù’¤Æ’¤ß’¤ì’¤Ð’¡¤’Ã±’½ã’¤Ê’¥Ó’¥Ã’¥È’±é’»»’¤Ç’½è’Íý’¤¹’¤ë’¤³’¤È’¤¬’²Ä’Ç½’¤Ç’¤¢’¤ë’¤³\n",
    "’¤È’¤¬’È½’ÌÀ’¤·’¤¿’¡¥’¤³’¤¦’¤·’¤Æ’¡¤2’¤Î’À°’¿ô’¾è’¤Î’¥Ç’¡¼’¥¿’¤Î’ÁÈ’¤Ë’ÂÐ’¤·’¤Æ’¤Ï’¡¤’¶Ë’¤á’¤Æ’¹â’Â®’¤Ë’¥Õ’¡¼’¥ê’¥¨’ÊÑ’´¹’¤ò’¼Â’¹Ô’¤¹’¤ë’¤³’¤È’¤¬’²Ä’Ç½’¤È’¤Ê’¤Ã’¤¿’¡¥\n",
    "FFT’¤Ç’¤Î’±é’»»’²ó’¿ô’¤Ï’¡¤’¥Ç’¡¼’¥¿’¿ô’¤òN’¤È’¤¹’¤ë’¤È\n",
    "\n",
    "$$\n",
    "N\\log_2 N\n",
    "$$\n",
    "’¤È’¤Ê’¤ë’¡¥’Ã±’½ã’¤Ê’¾ì’¹ç’¤Î$N^2$’¤È’Èæ’³Ó’¤¹’¤ë’¤È’¡¤’°Ê’²¼’¤Î’¤è’¤¦’¤Ë’¤Ê’¤ê’¡¤’¤É’¤ì’¤À’¤±’¹â’Â®’²½’¤µ’¤ì’¤Æ’¤¤’¤ë’¤«’¤¬’Íý’²ò’¤µ’¤ì’¤è’¤¦’¡¥\n",
    "```maple\n",
    "> dN2:=[]; dFft:=[]; for i from 2 to 16 do N:=2^i; n2:=N*N; Fft:=N/2*log[2](N);\n",
    "> Fft/n2; printf(\"%10d %12d %12d %10.5f\\n\",N,n2,Fft,evalf(Fft/n2));\n",
    "> dN2:=[op(dN2),[N,n2]]; dFft:=[op(dFft),[N,Fft]]; end do:\n",
    "```\n",
    "```maple\n",
    "         4           16            4    0.25000\n",
    "         8           64           12    0.18750\n",
    "        16          256           32    0.12500\n",
    "        32         1024           80    0.07812\n",
    "        64         4096          192    0.04688\n",
    "       128        16384          448    0.02734\n",
    "       256        65536         1024    0.01562\n",
    "       512       262144         2304    0.00879\n",
    "      1024      1048576         5120    0.00488\n",
    "      2048      4194304        11264    0.00269\n",
    "      4096     16777216        24576    0.00146\n",
    "      8192     67108864        53248    0.00079\n",
    "     16384    268435456       114688    0.00043\n",
    "     32768   1073741824       245760    0.00023\n",
    "     65536   4294967296       524288    0.00012\n",
    "```\n",
    "```maple\n",
    "> with(plots):\n",
    "> l1:=plot(dN2): l2:=plot(dFft):\n",
    "> display(l1,l2);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d14.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "```maple\n",
    "> l1:=logplot(dN2): l2:=logplot(dFft):\n",
    "> display(l1,l2);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d15.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "```maple\n",
    "> l1:=loglogplot(dN2): l2:=loglogplot(dFft):\n",
    "> display(l1,l2);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d16.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# FFT’´Ø’¿ô’¤ò’ÍÑ’¤¤’¤¿’·ë’²Ì\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "```maple\n",
    "> KK:=4;\n",
    "  N:=2^KK;i:='i';L:=1-0;\n",
    "  x1:=array([evalf(seq(F(i/N),i=0..N-1))]);\n",
    "  y1:=array([evalf(seq(0,i=0..N-1))]);\n",
    "```\n",
    "$$\n",
    "{\\it x1}\\, := \\, \\left[ \\begin {array}{cccccccccccccccc} - 1.0&- 1.0&- 1.0&- 1.0&- 1.0&- 1.0&- 1.0&- 1.0& 1.0& 1.0& 1.0& 1.0& 1.0& 1.0& 1.0& 1.0\\end {array} \\right] \\notag \\\\\n",
    "{\\it y1}\\, := \\, \\left[ \\begin {array}{cccccccccccccccc}  0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0\\end {array} \\right] \\notag\n",
    "$$\n",
    "```maple\n",
    "> FFT(KK,x1,y1);\n",
    "```\n",
    "$$\n",
    "16\n",
    "$$\n",
    "\n",
    "```maple\n",
    "> interface(displayprecision=2):\n",
    "  print(x1);print(y1);\n",
    "```\n",
    "$$\n",
    "\\left[ \\begin {array}{cccccccccccccccc}  0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0\\end {array} \\right] \\notag \\\\\n",
    "\\left[ \\begin {array}{cccccccccccccccc}  0.0& 10.05& 0.0& 2.99& 0.0& 1.34& 0.0& 0.40& 0.0&- 0.40& 0.0&- 1.34& 0.0&- 2.99& 0.0&- 10.05\\end {array} \\right] \\notag\n",
    "$$\n",
    "\n",
    "```maple\n",
    "> F2:=unapply(sum(evalf((x1[i]+I*y1[i])*exp(I*2*Pi*(i-1)/L*x)/N),i=1..N/2)+\n",
    "         sum(evalf((x1[N-i+2]+I*y1[N-i+2])*exp(-I*2*Pi*(i-1)/L*x)/N),i=2..N/2),x):\n",
    "> plot({Re(F2(x)),F(x)},x=0..1);\n",
    "```\n",
    "\n",
    "|{{attach_view(C10_FFTplot2d17.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ’²Ý’Âê’¤È’²ò’Åú’Îã\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<dl>\n",
    "<dt>’²Ý’Âê</dt><dd></dd>\n",
    "</dl>\n",
    "\n",
    "’²¼’¤Î’Îã’¤Ë’½¾’¤Ã’¤Æ’¡¤sin(i/13)’¤Èsin(i/2)’¤Î’¹ç’À®’ÇÈ’¤ò’ºî’À®’¤·’¡¤FFT’¤ò’¤«’¤±’¤¿’¸å’¡¤’¼þ’ÇÈ’¿ô’¤Ç’¤Î’¶¯’ÅÙ’¤ò’É½’¼¨’¤»’¤è’¡¥’¹ç’À®’ÇÈ(2*sin(i*2)+sin(i/2))’¤È’¤Î’°ã’¤¤’¤ò’¤Î’¤Ù’¤è’¡¥\n",
    "<dl>\n",
    "<dt>’²ò’Åú’Îã</dt><dd></dd>\n",
    "</dl>\n",
    "\n",
    "```maple\n",
    "restart:\n",
    "funcs:=[sin(i/13),sin(i/2)];\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#funcs:=[2*sin(i*2),sin(i/2)];\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "plot(funcs,i=0..300);\n",
    "```\n",
    "$$\n",
    "{\\it funcs}\\, := \\,[\\sin \\left( i/13 \\right) ,\\,\\sin \\left( i/2 \\right) ]\n",
    "$$\n",
    "\n",
    "|{{attach_view(FFTExplot2d1.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "```maple\n",
    "> data1:=[]:\n",
    "for i from 1 to 256 do\n",
    "  data1:=[op(data1),\n",
    "   evalf(funcs[1]+funcs[2])]; \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#   evalf(funcs[1])]; \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "end do:\n",
    "with(plots): \n",
    "listplot(data1);\n",
    "```\n",
    "\n",
    "|{{attach_view(FFTExplot2d2.png,)}}|\n",
    "|:----|\n",
    "\n",
    "\n",
    "```maple\n",
    "> X:=array(data1): \n",
    "Y:=array(1..256,sparse):\n",
    "FFT(8,X,Y);\n",
    "```\n",
    "$$\n",
    "256\n",
    "$$\n",
    "\n",
    "```maple\n",
    "> Data2:=[seq([i,sqrt(X[i]^2+Y[i]^2)],i=1..128)]:\n",
    "plot(Data2);\n",
    "```\n",
    "$$\n",
    "$$\n",
    "\n",
    "|{{attach_view(FFTExplot2d3.png,)}}|\n",
    "|:----|\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.1"
  },
  "latex_envs": {
   "LaTeX_envs_menu_present": true,
   "autocomplete": true,
   "bibliofile": "biblio.bib",
   "cite_by": "apalike",
   "current_citInitial": 1,
   "eqLabelWithNumbers": true,
   "eqNumInitial": 1,
   "hotkeys": {
    "equation": "Ctrl-E",
    "itemize": "Ctrl-I"
   },
   "labels_anchors": false,
   "latex_user_defs": false,
   "report_style_numbering": false,
   "user_envs_cfg": false
  },
  "toc": {
   "colors": {
    "hover_highlight": "#DAA520",
    "navigate_num": "#000000",
    "navigate_text": "#333333",
    "running_highlight": "#FF0000",
    "selected_highlight": "#FFD700",
    "sidebar_border": "#EEEEEE",
    "wrapper_background": "#FFFFFF"
   },
   "moveMenuLeft": true,
   "nav_menu": {
    "height": "12px",
    "width": "252px"
   },
   "navigate_menu": true,
   "number_sections": true,
   "sideBar": true,
   "threshold": 4,
   "toc_cell": true,
   "toc_section_display": "block",
   "toc_window_display": true,
   "widenNotebook": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
